version: "3.8"

services:
  osoc-backend:
    container_name: "osoc-backend"
    build: ./backend
    ports:
      - "8000:8000"
    environment:
      MONGO_URL: mongodb_container
      MONGO_PORT: 27017
      MONGO_USER: root
      MONGO_PASSWORD: justapassword
      REDIS_URL: redis
      REDIS_PORT: 6379
      REDIS_PASSWORD: justapassword
  
  mongodb_container:
    image: mongo:latest
    container_name: "mongodb"
    environment:
      MONGO_INITDB_ROOT_USERNAME: root
      MONGO_INITDB_ROOT_PASSWORD: justapassword
    ports:
      - 27017:27017
    volumes:
      - ./data/mongo:/data/db

  redis:
    image: redis:latest
    container_name: redis
    restart: always
    ports:
      - '6379:6379'
    command: redis-server --save 20 1 --loglevel warning --requirepass justapassword
    volumes: 
      - ./data/redis:/data